<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>ðŸ¤– Assistant Roblox Lua</title>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <style>
    body { 
      font-family: 'Segoe UI', sans-serif; 
      background: #0d0d0d; 
      color: #f5f5f5; 
      margin: 0; padding: 0; 
      display: flex; flex-direction: column; align-items: center;
    }
    h1 { margin: 20px; font-size: 28px; }
    .container { width: 80%; max-width: 800px; }
    .input-box { 
      display: flex; 
      background: #1e1e1e; 
      border-radius: 12px; 
      padding: 8px; 
      margin-bottom: 20px;
      box-shadow: 0 0 10px rgba(0,0,0,0.6);
    }
    input { 
      flex: 1; 
      border: none; 
      background: transparent; 
      color: white; 
      padding: 10px; 
      font-size: 16px;
    }
    input:focus { outline: none; }
    button { 
      background: #ff007f; 
      border: none; 
      color: white; 
      padding: 10px 16px; 
      border-radius: 8px; 
      font-weight: bold; 
      cursor: pointer; 
      transition: 0.2s;
    }
    button:hover { background: #ff3399; }
    .box { 
      background: #1e1e1e; 
      border-radius: 12px; 
      padding: 15px; 
      margin: 10px 0; 
      box-shadow: 0 0 5px rgba(255,255,255,0.1);
    }
    pre { 
      background: #111; 
      padding: 12px; 
      border-radius: 8px; 
      overflow-x: auto; 
      color: #00ff88;
    }
    a { color: #4fc3f7; text-decoration: none; }
    a:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <h1>ðŸ¤– Assistant Roblox Lua</h1>
  <div class="container">
    <div class="input-box">
      <input id="question" placeholder="Pose ta question..." onkeypress="if(event.key==='Enter'){ask()}">
      <button onclick="ask()">Envoyer</button>
    </div>
    <div id="response"></div>
  </div>

<script>
function ask(){
  fetch("/api/ask", {
    method:"POST", headers:{"Content-Type":"application/json"},
    body:JSON.stringify({question:document.getElementById("question").value})
  }).then(r=>r.json()).then(data=>{
    if(data.answer.includes("Je ne sais pas")) {
      search();
    } else {
      showAnswer(data.answer);
    }
  });
}

function search(){
  fetch("/api/search", {
    method:"POST", headers:{"Content-Type":"application/json"},
    body:JSON.stringify({question:document.getElementById("question").value})
  }).then(r=>r.json()).then(sites=>{
    let html = "<h2>ðŸ”Ž RÃ©sultats trouvÃ©s :</h2>";
    sites.results.forEach(s=>{
      html += `<div class="box">
        <a href="${s.url}" target="_blank"><b>${s.title}</b></a>
        <p>${s.snippet}</p>
      </div>`;
    });
    if(sites.code){
      html += `<div class="box"><h3>ðŸ’» Exemple de code :</h3><pre>${sites.code}</pre></div>`;
    }
    document.getElementById("response").innerHTML = html;
  });
}

function showAnswer(answer){
  document.getElementById("response").innerHTML =
    `<div class="box">${marked.parse(answer)}</div>`;
}
</script>
</body>
</html>
